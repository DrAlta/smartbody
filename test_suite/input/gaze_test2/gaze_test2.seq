### Assumes current directory is: core/smartbody/sbm/bin
### Simple Gaze Test Seq Script

# ---- Loading data/sbm-common assets
0	path seq ../../../../data/sbm-common/scripts
0	path ME ../../../../data/sbm-common/common-sk
0	echo >>> Loading common motions and poses...
0	load motions -R ../../../../data/sbm-common/common-sk
0	load poses   -R ../../../../data/sbm-common/common-sk

# ---- Using virtual timing
0	time sleepfps 0
0	time simfps 60
0	time reset

# ---- Setting characters and default posture
#  Common-sk assets are centered on the pelvis,
#  placed 102 units above the ground plane.
#  Using Unia (Unreal-based) class names for renderer assets
#  Using remote rVoice speech synthesis
#  NOTE: increment time to insure common-init is processed in order.
1	char doctor init common.sk SasoBase.SasoDoctorPerez
1	set character doctor world_offset x 35 y 102 h -17
1	set character doctor voice remote M021

1	char elder init common.sk SasoBase.Mayor
1	set character elder world_offset x -35 y 102 h 17
1	set character elder voice remote M009

#  Using "test bml" command to avoid hard-coding
#  message id into sequence file.
1	test bml character doctor noecho posture LHandOnHip_Motex
1	test bml character elder  noecho posture HandsAtSide_Motex


# ---- Setting Camera Parameters
# * Assumes doctor scaled character standing near the origin, as is about 200 units tall
1	viewer open   600 600  400 50
1	camera eye    0 166 185
1	camera center 0 92 0

#  Reference location for gazing
#  * This pawn does not follow the viewer camera
#  * Bug in pawn location/rotation initialization,
#    so set it once after initialization
1	pawn camera init loc 0 166 185
1	set pawn camera world_offset x 0 y 166 z 185

1	set test character doctor
1	set test recipient elder

# ---- Testing gaze
2 begin
test bml
<gaze target="elder">
<!-- Any or all of these options are available -->
<sbm:lumbar   heading="1" pitch="1" roll="1" blend="0.6" />
<sbm:thorax   heading="2" pitch="2" roll="2" blend="0.7" />
<sbm:cervical heading="3" pitch="3" roll="3" blend="0.8" />
<sbm:cranial  heading="4" pitch="4" roll="4" blend="0.9" />
<sbm:optical  heading="5" pitch="5" roll="5" blend="1.0" /></gaze>
end

3 snapshot
4 test bml <gaze target="elder:base"> </gaze>
5 snapshot
6 test bml <gaze target="elder:spine1"> </gaze>
7 snapshot
8 test bml <gaze target="elder:spine2"> </gaze>
9 snapshot
10 test bml <gaze target="elder:spine3"> </gaze>
11 snapshot
12 test bml <gaze target="elder:spine4"> </gaze>
13 snapshot
14 quit
